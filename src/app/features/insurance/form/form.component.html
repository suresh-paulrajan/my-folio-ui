<!-- src/app/features/insurance/insurance-form/insurance-form.component.html -->
<div class="insurance-form card">
  <div class="card-header">
    <h2>{{ isEdit ? 'Edit Policy' : 'Create Policy' }}</h2>
  </div>

  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="insurance-form card-body">

    <div class="row two-cols">
      <label>Policy Name <span class="req">*</span></label>
      <input type="text" formControlName="policy_name" placeholder="e.g. Family Health Shield" />
    </div>
    <div class="row two-cols">
      <label>Policy Type <span class="req">*</span></label>
      <select formControlName="policy_type">
        <option value="">-- Select --</option>
        <option *ngFor="let t of policyTypes" [value]="t">{{ t }}</option>
      </select>
    </div>

    <div class="row two-cols">
      <label>Insurer</label>
      <input type="text" formControlName="insurer" />
    </div>

    <div class="row two-cols">
      <label>Policy Number</label>
      <input type="text" formControlName="policy_number" />
    </div>

    <div class="row two-cols">
      <label>Premium Amount</label>
      <input type="number" min="0" step="0.01" formControlName="premium_amount" />
    </div>

    <div class="row two-cols">
      <label>Premium Frequency <span class="req">*</span></label>
      <select formControlName="premium_frequency">
        <option value="">-- Select --</option>
        <option *ngFor="let f of premiumFrequencies" [value]="f">{{ f }}</option>
      </select>
    </div>

    <div class="row two-cols">
      <label>Sum Assured</label>
      <input type="number" min="0" step="0.01" formControlName="sum_assured" />
    </div>

    <div class="row two-cols">
      <label>Start Date</label>
      <input type="date" formControlName="start_date" />
    </div>

    <div class="row two-cols">
      <label>Next Premium Due Date</label>
      <input type="date" formControlName="next_premium_due_date" />
    </div>

    <div class="row two-cols">
      <label>Maturity Date</label>
      <input type="date" formControlName="maturity_date" />
    </div>

    <div class="row two-cols">
      <label>Lead Days</label>
      <input type="number" formControlName="lead_days" min="0" />
    </div>

    <div class="row two-cols">
      <label>Grace Days</label>
      <input type="number" formControlName="grace_days" min="0" />
    </div>

    <div class="row two-cols">
      <label>Auto Debit</label>
      <input type="checkbox" formControlName="auto_debit" />
    </div>

    <div class="row two-cols">
      <label>Policy Status <span class="req">*</span></label>
      <select formControlName="policy_status">
        <option *ngFor="let s of policyStatuses" [value]="s">{{ s }}</option>
      </select>
    </div>

    <div class="row full-width">
      <label>Insured Member <span class="req">*</span></label>
      <select formControlName="insured_member_id">
        <option value="">-- Select member --</option>
        <option *ngFor="let m of members" [value]="m.member_id">{{ m.name }}</option>
      </select>
    </div>

    <div class="row full-width">
      <label>Notes</label>
      <textarea formControlName="notes" rows="4" placeholder="Optional notes..."></textarea>
    </div>

    <!-- validation messages -->
    <div class="errors" *ngIf="form.errors?.['dateOrder'] && (form.touched || form.dirty)">
      <div *ngIf="form.errors?.['dateOrder']">Check date order: start date must be earlier or equal to the compared date.</div>
    </div>

    <div class="server-error" *ngIf="serverError">{{ serverError }}</div>

    <div class="actions">
      <button type="button" class="btn btn-secondary" (click)="onCancel()">Cancel</button>
      <button type="submit" class="btn btn-primary" [disabled]="form.invalid || loading">
        {{ isEdit ? 'Update' : 'Save' }}
      </button>
    </div>
  </form>
</div>