<p-toast></p-toast>
<form [formGroup]="form" (ngSubmit)="onSubmit()" class="insurance-form">
  <input type="hidden" [value]="userId" name="user_id" />

  <!-- Section: Policy Details -->
  <h3 class="form-section-title">Policy Details</h3>
  <div class="form-grid">
    <div class="form-field">
      <label for="policyName">Policy Name *</label>
      <input pInputText id="policyName" formControlName="policy_name" />
    </div>

    <div class="form-field">
      <label for="policyType">Policy Type *</label>
      <p-select 
        [options]="policyTypes" 
        formControlName="policy_type"
        inputId="policyType"
        placeholder="Select">
      </p-select>
    </div>

    <div class="form-field">
      <label for="insurer">Insurer</label>
      <input pInputText id="insurer" formControlName="insurer" />
    </div>

    <div class="form-field">
      <label for="policyNumber">Policy Number</label>
      <input pInputText id="policyNumber" formControlName="policy_number" />
    </div>

    <div class="form-field">
      <label for="insuredMember">Insured Member *</label>
      <p-select 
        [options]="members" 
        optionLabel="relationship" 
        optionValue="member_id"
        formControlName="insured_member_id"
        inputId="insuredMember"
        placeholder="Select">
      </p-select>
    </div>

    <div class="form-field">
      <label for="insuredMemberName">Insured Member Name*</label>
      <input pInputText id="insuredMemberName" formControlName="insured_member_name"/>
    </div>
  </div>

  <!-- Section: Premium Info -->
  <h3 class="form-section-title">Premium Info</h3>
  <div class="form-grid">
    <div class="form-field">
      <label for="premiumAmount">Premium Amount</label>
      <input pInputText type="number" id="premiumAmount" formControlName="premium_amount" />
    </div>

    <div class="form-field">
      <label for="premiumFreq">Premium Frequency *</label>
      <p-select 
        [options]="premiumFrequencies" 
        formControlName="premium_frequency"
        inputId="premiumFreq"
        placeholder="Select">
      </p-select>
    </div>

    <div class="form-field">
      <label for="sumAssured">Sum Assured</label>
      <input pInputText type="number" id="sumAssured" formControlName="sum_assured" />
    </div>
  </div>

  <!-- Section: Dates -->
  <h3 class="form-section-title">Dates</h3>
  <div class="form-grid">
    <div class="form-field">
      <label for="startDate">Start Date</label>
      <input pInputText type="date" id="startDate" formControlName="start_date" />
    </div>

    <div class="form-field">
      <label for="nextDue">Next Premium Due</label>
      <input pInputText type="date" id="nextDue" formControlName="next_premium_due_date" />
    </div>

    <div class="form-field">
      <label for="maturityDate">Maturity Date</label>
      <input pInputText type="date" id="maturityDate" formControlName="maturity_date" />
    </div>
  </div>

  <!-- Section: Other Settings -->
  <h3 class="form-section-title">Other Settings</h3>
  <div class="form-grid">
    <div class="form-field">
      <label for="leadDays">Lead Days</label>
      <input pInputText type="number" id="leadDays" formControlName="lead_days" />
    </div>

    <div class="form-field">
      <label for="graceDays">Grace Days</label>
      <input pInputText type="number" id="graceDays" formControlName="grace_days" />
    </div>

    <div class="form-field">
      <label for="policyStatus">Policy Status *</label>
      <p-select 
        [options]="policyStatuses" 
        formControlName="policy_status"
        inputId="policyStatus"
        placeholder="Select">
      </p-select>
    </div>

    <div class="checkbox-wrapper">
      <p-checkbox formControlName="auto_debit" binary="true" inputId="autoDebit"></p-checkbox>
      <label for="autoDebit">Auto Debit</label>
    </div>
  </div>

  <!-- Notes -->
  <div class="form-grid single-col">
    <div class="form-field full-width">
      <label for="notes">Notes</label>
      <textarea pTextarea id="notes" formControlName="notes" rows="3"></textarea>
    </div>
  </div>

  <!-- Actions -->
  <div class="actions">
    <button type="button" pButton label="Cancel" class="p-button-secondary" (click)="onCancel()"></button>
    <button type="submit" pButton label="{{ isEdit ? 'Update' : 'Save' }}" class="p-button-primary" [disabled]="form.invalid || loading"></button>
  </div>
</form>